function e(){return(e=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e}).apply(this,arguments)}var n,r;if("undefined"!=typeof process&&(n={emit:process.emit,listeners:process.listeners,addListener:process.addListener,removeListener:process.removeListener,removeAllListeners:process.removeAllListeners}),"undefined"!=typeof window){var t=new Map;n={emit:function(e,n){window.dispatchEvent(new CustomEvent(e,{detail:n}))},listeners:function(){return Array.from(t.keys())},addListener:function(e,n){var r=function(e){return n(e.detail)};window.addEventListener(e,r),t.set(n,r)},removeListener:function(e,n){var r=t.get(n);void 0!==r&&(window.removeEventListener(e,r),t.delete(n))},removeAllListeners:function(e){Array.from(t.values()).map(function(n){window.removeEventListener(e,n)}),t.clear()}}}function o(e,t,o){var i="";"object"==typeof e&&void 0!==e.message?i=e.message:"string"==typeof e&&(i=e);var s={tag:t,level:o,message:i};if("object"==typeof e&&void 0!==e.stack)s.stack=e.stack;else if(o<=r.error){var a=new Error;if(void 0!==a.stack){var v=a.stack.split("\n");s.stack=[v[0]].concat(v.slice(3)).join("\n")}}n.emit("stencila:logga",s)}function i(){return n.listeners("stencila:logga")}function s(e,r){void 0===r&&(r={});var t=e,o=r.tags,i=r.maxLevel,s=r.messageRegex,a=r.func;return void 0===o&&void 0===i&&void 0===s&&void 0===a||(t=function(n){(void 0===o||o.includes(n.tag))&&(void 0!==i&&n.level>i||(void 0===s||s.test(n.message))&&(void 0===a||a(n))&&e(n))}),n.addListener("stencila:logga",t),t}function a(e){n.removeListener("stencila:logga",e)}function v(){n.removeAllListeners("stencila:logga")}function d(e){v(),s(e)}!function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=2]="info",e[e.debug=3]="debug"}(r||(r={}));var c=new Map;function f(n,t){void 0===t&&(t={});var o=n.tag,i=n.level,s=n.message,a=n.stack,v=t.maxLevel;if(!(i>(void 0===v?r.info:v))){var d=t.throttle;if(void 0!==d){var f=(void 0!==d.signature?d.signature:"").replace(/\${tag}/,o).replace(/\${level}/,i.toString()).replace(/\${message}/,s),l=c.get(f);if(void 0!==l){var u=void 0!==d.duration?d.duration:1e3;if(Date.now()-l<u)return}c.set(f,Date.now())}var g="";if("undefined"!=typeof process&&void 0!==process.stderr&&!0!==process.stderr.isTTY)g=JSON.stringify(e({time:(new Date).toISOString()},n));else{var p=i<0?0:i>3?3:i,m=r[p].toUpperCase().padEnd(5," ");g="undefined"!=typeof window?m+" "+o+" "+s:["üö®","‚ö†","üõà","üêõ"][p]+" "+["[31;1m","[33;1m","[34;1m","[30;1m"][p]+m+"[0m [36m"+o+"[0m "+s;var w=t.showStack;void 0!==w&&w&&void 0!==a&&(g+="\n  "+a)}console.error(g);var L=t.exitOnError;"undefined"!=typeof process&&(void 0===L||L)&&i===r.error&&process.exit(1)}}function l(e){return{error:function(n){o(n,e,r.error)},warn:function(n){o(n,e,r.warn)},info:function(n){o(n,e,r.info)},debug:function(n){o(n,e,r.debug)}}}0===i().length&&s(f);export{r as LogLevel,s as addHandler,f as defaultHandler,l as getLogger,i as handlers,a as removeHandler,v as removeHandlers,d as replaceHandlers};
//# sourceMappingURL=logga.mjs.map
