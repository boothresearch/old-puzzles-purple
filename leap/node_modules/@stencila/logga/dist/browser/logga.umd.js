!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((e=e||self).logga={})}(this,function(e){function n(){return(n=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}var r,o;if("undefined"!=typeof process&&(r={emit:process.emit,listeners:process.listeners,addListener:process.addListener,removeListener:process.removeListener,removeAllListeners:process.removeAllListeners}),"undefined"!=typeof window){var t=new Map;r={emit:function(e,n){window.dispatchEvent(new CustomEvent(e,{detail:n}))},listeners:function(){return Array.from(t.keys())},addListener:function(e,n){var r=function(e){return n(e.detail)};window.addEventListener(e,r),t.set(n,r)},removeListener:function(e,n){var r=t.get(n);void 0!==r&&(window.removeEventListener(e,r),t.delete(n))},removeAllListeners:function(e){Array.from(t.values()).map(function(n){window.removeEventListener(e,n)}),t.clear()}}}function i(n,o,t){var i="";"object"==typeof n&&void 0!==n.message?i=n.message:"string"==typeof n&&(i=n);var s={tag:o,level:t,message:i};if("object"==typeof n&&void 0!==n.stack)s.stack=n.stack;else if(t<=e.LogLevel.error){var a=new Error;if(void 0!==a.stack){var d=a.stack.split("\n");s.stack=[d[0]].concat(d.slice(3)).join("\n")}}r.emit("stencila:logga",s)}function s(){return r.listeners("stencila:logga")}function a(e,n){void 0===n&&(n={});var o=e,t=n.tags,i=n.maxLevel,s=n.messageRegex,a=n.func;return void 0===t&&void 0===i&&void 0===s&&void 0===a||(o=function(n){(void 0===t||t.includes(n.tag))&&(void 0!==i&&n.level>i||(void 0===s||s.test(n.message))&&(void 0===a||a(n))&&e(n))}),r.addListener("stencila:logga",o),o}function d(){r.removeAllListeners("stencila:logga")}(o=e.LogLevel||(e.LogLevel={}))[o.error=0]="error",o[o.warn=1]="warn",o[o.info=2]="info",o[o.debug=3]="debug";var v=new Map;function l(r,o){void 0===o&&(o={});var t=r.tag,i=r.level,s=r.message,a=r.stack,d=o.maxLevel;if(!(i>(void 0===d?e.LogLevel.info:d))){var l=o.throttle;if(void 0!==l){var c=(void 0!==l.signature?l.signature:"").replace(/\${tag}/,t).replace(/\${level}/,i.toString()).replace(/\${message}/,s),f=v.get(c);if(void 0!==f){var g=void 0!==l.duration?l.duration:1e3;if(Date.now()-f<g)return}v.set(c,Date.now())}var u="";if("undefined"!=typeof process&&void 0!==process.stderr&&!0!==process.stderr.isTTY)u=JSON.stringify(n({time:(new Date).toISOString()},r));else{var p=i<0?0:i>3?3:i,m=e.LogLevel[p].toUpperCase().padEnd(5," ");u="undefined"!=typeof window?m+" "+t+" "+s:["üö®","‚ö†","üõà","üêõ"][p]+" "+["[31;1m","[33;1m","[34;1m","[30;1m"][p]+m+"[0m [36m"+t+"[0m "+s;var L=o.showStack;void 0!==L&&L&&void 0!==a&&(u+="\n  "+a)}console.error(u);var w=o.exitOnError;"undefined"!=typeof process&&(void 0===w||w)&&i===e.LogLevel.error&&process.exit(1)}}0===s().length&&a(l),e.addHandler=a,e.defaultHandler=l,e.getLogger=function(n){return{error:function(r){i(r,n,e.LogLevel.error)},warn:function(r){i(r,n,e.LogLevel.warn)},info:function(r){i(r,n,e.LogLevel.info)},debug:function(r){i(r,n,e.LogLevel.debug)}}},e.handlers=s,e.removeHandler=function(e){r.removeListener("stencila:logga",e)},e.removeHandlers=d,e.replaceHandlers=function(e){d(),a(e)}});
//# sourceMappingURL=logga.umd.js.map
